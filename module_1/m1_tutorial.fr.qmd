---
title: "Tutoriel"
---

## A propos de ce tutoriel

Dans ce tutoriel vous d√©couvrirez l'interface des listes lin√©aires OutbreakTools^[Pour rappel, toutes les listes lin√©aires OBT ont la m√™me interface] et le tableau de bord correspondant.

### üéØ Objectifs

- Explorer les fonctionnalit√©s de la liste lin√©aire OBT, en insistant sur la r√©solution de probl√®mes et l'exploration des analyses
- Acc√©der au tableau de bord et savoir l'utiliser pour explorer les donn√©es

### üß≠ Contexte

MSF travaille dans l'est et le sud du Tchad depuis 2006 et fournit des soins m√©dicaux et une assistance aux personnes d√©plac√©es et aux communaut√©s locales dans un contexte d'acc√®s difficile √† la nourriture.

En d√©cembre 2021, suite √† plusieurs signalements de cas de rougeole dans la r√©gion m√©ridionale de Mandoul, MSF a d√©cid√© de r√©pondre √† l'√©pid√©mie avec Epicentre en soutien. 

Une liste lin√©aire est n√©cessaire pour collecter les donn√©es des patients dans les structures. Vous discutez avec le MedRef et le MedCo, et prenez la d√©cision de d√©ployer la liste lin√©aire rougeole OBT.


### Activit√©s

Vous utiliserez plusieurs fichier lors de ce tutoriel :

- une liste lin√©aire vide √† pr√©parer avant un d√©ploiement
- une liste lin√©aire avec de fausses donn√©es pour r√©pliquer une liste lin√©aire en cours d'utilisation
- une liste lin√©aire avec de fausses donn√©es et quelques probl√®mes √† r√©soudre.

Vous visiterez ensuite le tableau de bord intersection pour explorer les donn√©es _r√©elles_ de MSF sur la rougeole au Tchad.

Les explications seront donn√©es dans le texte ou dans des encadr√©s (conseils, notes, etc.) et les instructions seront donn√©es dans des encadr√©s sp√©cifiques :

::: {.callout-warning}
Je suis une information importante
:::

::: {.callout-tip}
Je suis une information utile mais qui peut √™tre omise si vous √™tes press√© par le temps, mais je m√©rite qu'on me lise √† un moment.
:::

::: {.instructions}
A votre tour !
:::

## Pr√©paration

### T√©l√©chargez et d√©zippez les documents

Les fichiers que vous devrez utiliser sont stock√©s sur GitHub dans une archive `zip`. 

::: {.instructions}
1. Cliquez sur le bouton ci-dessous pour t√©l√©charger l'archive. Enregistrez-la sur votre ordinateur (dans vos *T√©l√©chargements* par exemple)

```{r}
#| echo: false
#| eval: true

downloadthis::download_link(
  link = "https://github.com/epicentre-msf/obt-training/raw/master/tutorials_materials/module_1.zip",
  button_label = "T√©l√©charder l'archive",
  has_icon = TRUE,
  icon = "fa fa-save",
  self_contained = FALSE
)
```

2. D√©zippez l'archive pour sauvegarder les fichiers localement. Il est conseill√© de d√©zipper vers un emplacement qui n'est pas activement synchronis√© avec OneDrive en ce moment.
:::


### Contenu de larchive

- Une liste lin√©aire OBT rougeole √† jour (version standard), vide
- La m√™me version de fichier, mais avec des donn√©es rougeole (simul√©es)


## Partie 0 : d√©bloquer les fichiers et les macros {#sec-unblock-file}

Les listes lin√©aires OBT utilisent des macros VBA pour ajouter des fonctionnalit√©s. Cela fait qu'elles doivent souvent √™tre *d√©loqu√©es* sur votre ordi lorsque qu'elles proviennent d'internet, et vous devrez autoriser l'ex√©cution des macros.


::: {.instructions}
D√©bloquez les fichiers ou assurez-vous qu'ils le sont d√©j√†. Si vous ne l'avez jamais fait auparavant, [suivez ces √©tapes](../how_to/unblock_files.qmd)
:::

::: {.callout-note}
En fonction du niveau de protection de votre ordinateur et de la source des fichiers, vous aurez peut √™tre √† le faire ou non. Par contre, les ordinateurs terrain sont souvent plus prot√©g√©s et il est tr√®s probable que vos coll√®gues aient √† le faire, donc soyez pr√™t √† expliquer ces √©tapes.
:::

## Partie 1 : pr√©parer et d√©ployer une liste lin√©aire

### Obtenir les fichiers n√©c√©ssaires

#### Un mod√®le de liste lin√©aire

Dans la vraie vie il vous faudra un [mod√®le vide](https://epicentre-msf.github.io/outbreak-tools/getting_started/get_linelist.html) pour vous lancer, mais dans le cadre ce cet exercice vous utiliserez le fichier vide inclus dans l'archive que vous avez t√©l√©charg√©e.

::: {.instructions}
Identifiez le fichier correct et faites une copie pour pouvoir travailler dessus.
:::


#### Une g√©obase adapt√©e

::: {.instructions}
Rendez-vous sur le site de la [GeoApp](https://reports.msf.net/secure/app/outbreak-tools-geoapp) et t√©l√©chargez une base g√©ographique pour le Tchad. Vous pouvez lire un r√©sum√© des √©tapes [ici](https://epicentre-msf.github.io/outbreak-tools/how_to/import_geobase.html#sec-geobase-download), ou directement sur le site, √† l'ouverture.
:::

Le fichier n'est pas prot√©g√©, vous pouvez l'ouvrir si vous √™tes curieux.


### Pr√©parer une liste lin√©aire {#sec-customise}

::: {.instructions}
Ouvrez la liste lin√©aire et inspectez les onglets
:::

**Notablement** : 

- La premi√®re feuille contient un guide d'utilisation (qui sera bient√¥t traduit), il n'y a rien √† faire dessus
- La deuxi√®me feuille ("Info") contient des informations sur le projet et le site (m√©tadonn√©es)
- La troisi√®me feuille ("Linelist patients") contient les donn√©es des patients
- La plupart des feuilles suivantes contiennent des analyses.

::: {.instructions}
Localisez le [menu OutbreakTools](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html), nous allons l'utiliser intensivement pendant les exercices.
:::


![Rubban, ou menu OutbreakTools](../module_1/images/015-img-ribbon-linelist.png){fig-align="center"}


#### Remplir les m√©tadonn√©es

**M√©tadonn√©es obligatoires**

::: {.instructions}
Remplissez la feuille "Info" (m√©tadonn√©es) :

- `Organisation`: entrez votre nom de section
- `Nom du pays`: Tchad
- `Nom de la structure`: Mo√Øssala Hospital
:::

Une fois que ces champs sont remplis, ils ne devraient plus √™tre modifi√©s. Ces informations seront utilis√©es au moment de la cr√©ation d'exports.

**M√©tadonn√©es optionnelles**

::: {.instructions}
Rentrez les infos des champs `Admin 1` (Mandoul) et `Admin 2` (Moissala)
:::


#### Cacher les champs non utilis√©s

Vu que l'on n'a pas utilis√© les autres champs, cachons-les !

::: {.instructions}
En gardant le focus sur la feuille "Info", rendez-vous dans le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html). Cliquez sur le bouton "Afficher / Masquer les variables".
:::

Une fen√™tre pop-up s'ouvre :


![Fen√™tre pop-up](../module_1/images/003-img-obt-show_hide.png){fig-align="center"}

Vous pouvez voir que certaines variables ont un statut `Obligatoire`; ces variables ne peuvent √™tre cach√©es avec cet outil. D'autres variables ont le statut `Affich√©` et elles peuvent √™tre cach√©es. 

::: {.instructions} 
Cachez les variables que l'on n'a pas remplies. Vous pouvez soit les cacher unes par unes, soit utiliser le bouton "Cachez toutes les variables optionnelles" deux fois et d√©-cacher les variables que l'on veut voir.
:::


#### Importer la g√©obase

::: {.instructions} 
Cliquez sur le bouton "Importer une g√©obase" dans le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html) pour importer la base g√©o que vous avez t√©l√©charg√© pr√©c√©demment.
:::

Apr√®s avoir re√ßus le message de confirmation, vous pouvez v√©rifier l'import en allant sur la feuille des donn√©es patients, et en regardant les colonnes "g√©o" (dont le fond est de couleur saumon). Si tout s'est bien pass√© :

- Les labels devraient avoir √©t√© mis √† jour avec les noms des niveaux administratifs pr√©sents dans la g√©obase (e.g. "adm1_name‚Äù va devenir ‚ÄúProvince‚Äù pour la RDC).
- Les cellules de la premi√®re colonne (admin 1) devraient contenir un menu d√©roulant avec les valeurs import√©es depuis la g√©obase.

Vous pouvez remplir les colonnes g√©ographiques soit √† partir des menus d√©roulants en cascade (en commen√ßant pas le niveau 1), soit en utilisant le bouton [GeoHelper](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html#sec-geo-helper) du menu OBT.

::: {.callout-important}
Il y a une hi√©rarchie entre les niveaux administratifs : si vous essayez de remplir la colonne 3 *sans avoir rempli les colonnes 1 et 2* le menu d√©roulant apparaitra comme vide.
:::


#### Param√©trer le jour de la semaine
  
::: {.instructions} 
Cliquez sur le bouton "D√©but de semaine" du menu OBT et choisissez le "Lundi" comme premier jour de la semaine.
:::

#### Cachez / montrer des variables

On peut aussi cacher ou montrer les variables optionnelles sur la feuille des donn√©es patients. Lorsque vous pr√©parez une liste lin√©aire, il vous faut d√©cider quelles variables collecter en fonction informations dont vous avez besoin^[Vous pouvez cacher ou montrer des variables plus tard, pendant la collecte des donn√©es si besoin, mais dans ce cas gardez en t√™te que les donn√©es pour ces colonnes ne seront que partielles.].


::: {.instructions} 
Placez vous sur la feuille "Linelist Patients" et cliquez sur le bouton "Afficher/Masquer des variables". Cachez toutes les variables optionnelles √† l'aide du bouton, et d√©-cachez manuellement :

- Structure d√©clarante
- Fi√®vre
- Eruption maculopapulaire
- Toux
- Yeux rouges - conjonctivite
- MUAC
- Enceinte
- Les variables "extra" √† la fin
- N'importe quelle variable calcul√©e que *vous* souhaitez voir (num√©ro de semaine, groupe d'√¢ge  etc.)
:::


#### Imprimer un registre

::: {.instructions}
Cliquez sur le bouton "Afficher le registre" du [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html).
:::

Cela ouvre une feuille qui est cach√©e par d√©faut pour pr√©parer un registre √† imprimer, au cas o√π il n'y en aurait pas d√©j√† un dans le centre.

En r√®gle g√©n√©rale, il devrait y avoir moins de colonnes dans le registre que dans la linelist, vu que certaines des informations viennent du dossier patient ou d'autres sources.

::: {.instructions}

1. Une fois sur la nouvelle feuille, cliquez sur le bouton "Afficher/masquer les variables" pour ouvrir la fen√™tre pop-up pour le registre.

<!-- 2. Cliquez sur le bouton "Correspondre au Show/Hide de la linelist" pour aligner la visibilit√© des variables du registre sur celles de la feuille patients. -->

2. Cachez les variables qui n'ont pas besoin d'√™tre dans le registre.
:::


Maintenant que vous avez s√©lectionn√© les variables √† imprimer, il faut am√©liorer un peu l'aspect pour qu'il soit plus pratique √† utiliser :

- Ajuster la largeur des colonnes pour que les encodeurs de donn√©es puisse √©crire
- Changer l'orientation des labels pour gagner de l'espace s'il n'y a pas grand chose √† √©crire
- Ajouter des lignes √† la table pour qu'elle fasse une page^[Astuce: il y a un bouton pour √ßa dans le menu OBT !].

::: {.instructions}
Ajustez la largeur des colonnes : 

- `Nom / Pr√©nom`: plus large
- `Sexe`: moins large

Pour voir, cliquez sur le bouton "Imprimer" (toujours dans le [menu OBT menu](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html)). Remarquez le bouton "Mise en page" en haut √† gauche, qui contr√¥le les param√®tres d'impression.

Une fois que vous avez pris connaissance de ces boutons, vous pouvez sortir de l'aper√ßu avant impression puis cliquer sur le bouton "Fermer le registre / CRF" pour **cacher** la feuille registre (vos modifications sur cette feuille demeurent).
:::

#### Pr√©parer un formulaire des cas

Avec la m√™me id√©e que pour le registre il est possible d'imprimer un formulaire de cas √† partir de la liste lin√©aire s'il n'y en a pas d√©j√† un dans la structure. Un bouton affiche une feuille pr√©par√©e automatiquement. Cr√©er un CRF propre est au del√† des capacit√©s d'OBT pour le moment, mais ce brouillon devrait √™tre une base et vous faire gagner du temps.

Choses que vous pourriez faire :

- Cacher les variables collect√©es √† un autre endroit ou calcul√©es
- Cacher / condenser les lignes vides
- Raccourcir des labels^[D√©sormais, une option a √©t√© rajout√©e au ficher **setup** pour donner des labels courts ou des acronymes, mais ils n'ont pas √©t√© remplis pour toutes les listes lin√©aires OBT en circulation pour le moment.].

Pr√©parer un CRF propre nous prendrait trop de temps, nous ne le ferons pas lors de ce tutoriel, mais n'h√©sitez pas √† ouvrir la feuille un instant avec le bouton "Afficher le CRF" pour voir √† quoi elle ressemble.


### D√©ployer la linelist

Nous avons fait le tour des pr√©parations principales √† effectuer sur la liste lin√©aire. N'oubliez pas d'enregistrer votre fichier.

Vous pouvez √† pr√©sent l'envoyer √† vos coll√®gues. S'ils ont d√©j√† travaill√© avec des linelists OBT (y compris sur d'autres maladies), c'est facile : toutes les listes lin√©aires OBT ont la m√™me interface, ils devraient se sentir √† l'aise.

Si vos coll√®gues n'ont pas travaill√© avec une liste lin√©aire OBT, il faut leur montrer en particulier : 

- Comment [d√©bloquer le fichier et autoriser les macros](../how_to/unblock_files.qmd)
- le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html)
- Comment remplir les m√©tadonn√©es sur la feuille "Info" (s'il en reste √† remplir)
- Comment [exporter les donn√©es vers le tableau de bord](https://epicentre-msf.github.io/outbreak-tools/how_to/send_data_to_dashboard.html)
- Comment utiliser le bouton [GeoHelper](../how_to/use_geohelper.qmd)

Le plus souvent il devrait y avoir une liste lin√©aire par site.


## Partie 2 : usage de la liste lin√©aire

### üß≠ Contexte

La linelist a √©t√© d√©ploy√©e en Janvier 2022 √† Moissala et les zones alentour. Un peu plus d'un an plus tard, en avril 2023, l'√©pid√©mie fait toujours rage, et la linelist est toujours utilis√©e. Vous recevez le fichier avec les donn√©es r√©guli√®rement pour le suivi de l'√©pid√©mie...

Nous allons dans cette partie travailler sur le fichier `linelist_rougeole_mandoul.xlsb` qui contient des donn√©es rougeole simul√©es^[En essayant au maximum d'utiliser les param√®tres des linelists rougeoles de MSF, au moins pour les variables principales, ce qui nous √©vite des probl√®mes de confidentialit√©.].


### Contr√¥les de routine

Lorsque vous recevez une liste lin√©aire avec des donn√©es, nous vous conseillons d'effectuer quelques v√©rifications basiques pour avoir une id√©e de l'√©tat du fichier et des donn√©es. Ce ne sont pas les v√©rifications longues, complexes ou compl√®tes que vous effectueriez si vous √©tiez responsables du suivi qualit√© des donn√©es, ou si vous vouliez effectuer des analyses. Mais ces v√©rifications vont vous aider √†  d√©tecter les sources de quelques probl√®mes plus rapidement.


#### Contr√¥le du fichier

**Est-ce que le fichier est endomag√© / corrompu ?**

- Est ce que les boutons du menu OBT semblent normaux / leurs √©tiquettes lisibles ?
- Testez un bouton (comme le "Montrer / Cacher les variables") : est ce qu'il fonctionne normalement ?
- Est ce que les feuilles attendues sont pr√©sentes ?

::: {.callout-warning}
Si les boutons du menu OBT ont des noms bizarres, ou pas de noms du tout, c'est probablement que le VBA a √©t√© bloqu√©, ou, plus rarement, a plant√©. V√©rifiez les autorisations des macros, ajustez-les si besoin, fermez Excel puis r√©ouvrez le fichier.


Si le probl√®me persiste, tentez un "Exporter pour migration" pour transf√©rer les donn√©es vers une linelist vide. Si l'export ne fonctionne pas parce que le VBA s'est corrompu, contactez l'√©quipe EpiDS qui vous aidera √† transf√©rer les donn√©es.
:::

::: {.instructions}
Effectuez ces v√©rifications sur le fichier `linelist_rougeole_mandoul.xlsb`.
:::


#### Contr√¥le (basiques) des donn√©es

- Est-ce que les m√©tadonn√©es sur la feuille "Info" sont correctement remplies^[90% des probl√®mes li√©s √† l'export vers le tableau de bord sont li√©s √† √ßa.]?
- Est-ce que tous les patients ont un num√©ro ?
- Est-ce qu'il y a des num√©ros de patient dupliqu√©s ?
- V√©rifiez quelques colonnes contenant des dates √† l'aide des filtres : est ce que les dates sont dans le bon format et sont raisonnables (min, max) ?
- V√©rifiez quelques colonnes contenant des cat√©gories (`sexe`, `sortie`...) pour voir si les cat√©gories sont rentr√©e correctement
- Enlevez tous les filtres pr√©sents sur les donn√©es (il y a un bouton dans le menu OBT pour gagner du temps)

::: {.instructions}
Effectuez ces v√©rifications sur le fichier `linelist_rougeole_mandoul.xlsb`.
:::

### Analyses

Maintenant que nous nous sommes convaincu que le fichier n'est pas cass√©, et que les donn√©es ne sont pas horribles, penchons nous sur les analyses descriptives embarqu√©es dans la liste lin√©aire.

Bien que l'interface g√©n√©rale soit la m√™me pour toutes les listes lin√©aires OBT, les analyses sont encod√©es dans le fichier **setup** et varient donc d'une maladie √† une autre, en fonction de ce qui a √©t√© demand√©. Ceci √©tant dit, la majorit√© des listes lin√©aires OBT contiennent des analyses uni et bivari√©es, ainsi que des analyses temporelles et spatiales.

Il y a quelques point √† retenir sur les analyses dans les listes lin√©aires OBT : 

1. Les analyses **doivent √™tre mises √† jour** manuellement avant utilisation.

![Bouton de mise √† jour des analyses dans le menu OBT](../module_1/images/004-refresh.png){fig-align="center"}

2. Si vous filtrez les donn√©es dans la feuille patients, cela sera refl√©t√© dans les analyses *apr√®s mise √† jour* (un texte en rouge vous avertira que c'est le cas).

3. Vous pouvez modifier l'apparence des graphiques (qui sont cr√©es automatiquement et, nous le conc√©dons, peu moches par d√©faut). Vous pouvez pour cela utiliser les [outils classiques d'Excel](https://support.microsoft.com/fr-fr/office/mettre-en-forme-les-%C3%A9l%C3%A9ments-d-un-graphique-b6c787d5-f90a-41d2-a901-9d3ed9f0dbf0), comme vous le feriez pour vos propres figures^[Malheureusement, les modifications des graphiques ne peuvent pas √™tre migr√©es vers une autre linelist, donc je vous conseille de vous restreindre aux graphes qui sont peu lisibles, que vous exportez r√©guli√®rement dans des rapports ou pr√©sentations, ou qui vous font _vraiment_ saigner les yeux.].

Nous allons commencer par explorer les analyses sur les donn√©es non filtr√©es.

::: {.instructions}
1. Placez-vous sur la feuille contenant les donn√©es patients

2. Tapez sur la touche **F9** (force le calcul de toutes les formules)

3. Ouvrez le menu OBT et cliquez sur le bouton pour nettoyer tous les filtres. 

4. Ensuite, mettez √† jour les analyses.
:::

Maintenant que les analyses sont pr√™tes, nous allons pouvoir les explorer.


#### Personnes : analyses uni et bivari√©es

Cette feuille contient des tableaux √† simple et double entr√©e et des diagrammes en b√¢tons d√©crivant des informations basiques sur les patients : d√©mographie, symptomes, sorties etc.

::: {.instructions}
Explorez la feuille et r√©pondez aux questions suivantes :

- Quelle est la dur√©e de s√©jour moyenne ?
- Combien de patients ont plus de 15 ans ?
- Combien de patients sont des femmes ou des filles ?
- Quel est le pourcentage de rougeole compliqu√©e ?
- Combien de patients sont malnutris s√©v√®re (SAM) ?
- Combien de patients sont d√©c√©d√©s dans la structure de sant√© ?
- Combien de patients sont des gar√ßons de moins de cinq ans ?
- Combien de patients SAM sont positifs au test palu ?
:::

Int√©ressons nous √† pr√©sent aux caract√©ristiques des patients d√©c√©d√©s.

::: {.instructions}
1. Retournez dans la feuille des donn√©es patients. Utilisez les filtres pour s√©lectionner seulement les patients d√©c√©d√©s (dans le centre ou dans la communaut√©, comme vous voulez).

2. Rafra√Æchissez les analyses et retournez sur la feuille des tableaux simples.

- Combien de filles entre un et quatre ans sont d√©c√©d√©es ?
- Combien de patients d√©c√©d√©s √©taient malnutris mod√©r√©s (MAM) ?
:::


#### Temps : analyses temporelles

Maintenant allons sur le feuille "Analyses temporelles". Sur cette feuille, vous pouvez choisir l'√©chelle temporelle √† explorer : jours, semaines, mois etc. La table contient 53 lignes, et peut donc montrer : 

- un zoom sur une p√©riode de 53 jours (d√©but de l'√©pid√©mie par exemple)
- un an de donn√©es (53 semaines)
- 53 mois, pour des √©pid√©mies longues
- 53 quarts d'ann√©es ou ann√©es (utilisation rare, pas pour une linelist patient)


![Param√©trer les analyses temporelles](../module_1/images/007-img-temporal-table.png){fig-align="center"}

Les courbes √©pid√©miques sont en dessous des tableaux.

::: {.callout-note}
Cette liste lin√©aire contient un seul gros tableau, mais d'autres linelists peuvent contenir plusieurs tableaux, organis√©s en sections. Les graphiques seront tout le temps apr√®s les tables.
:::

::: {.instructions}
- Enlevez les filtres qui √©taient sur les donn√©es et mettez √† jour les analyses.
- V√©rifiez les dates de notification des cas minimum et maximum. Quelles sont les unit√©s √† consid√©rer pour les analyses temporelles ?
- Dans un premier temps, utilisons l'unit√© `semaine`. Est-ce que toutes les donn√©es sont repr√©sent√©es dans la table ?
- Combien de patients ont √©t√© d√©charg√©s lors de la semaine 18 de 2023 ?
- Maintenant, changez la date de d√©but de p√©riode pour ne faire afficher que les semaines de 2023.
- Combien de patients √©taient hospitalis√©s dans la seconde semaine de Janvier 2023 ?
- Changez les unit√©s en `Mois`. Combien de patients ont √©t√© admis en Janvier 2023 ?
:::

Maintenant, allons voir les graphiques. Vous devriez voir un graphique similaire √† celui-ci : 

![Hospitalisations](../module_1/images/008-img-temporal-hospit_raw.png){fig-align="center"}

C'est suffisant pour √©tablir l'√©tat de l'√©pid√©mie, mais vous ne voudriez pas exporter la figure en l'√©tat dans un rapport ou une pr√©sentation. En plus d'am√©liorations cosm√©tiques de l'apparence, il faudrait utiliser les filtrer du graphique pour cachez les semaines vides √† la droite du graphique : 

- s√©lectionner le graphe : quelques boutons apparaissent alors dans le coin en haut √† droite.
- utiliser le bouton pour filtrer pour filtrer les cat√©gories que vous ne voulez pas voir (icone en forme d'entonnoir, le dernier).


::: {.callout-warning}
N'oubliez pas d'enlever ou d'ajuster les filtres lorsque vous ajoutez de nouvelles donn√©es, ou vous ne les verrez pas sur le graphique !

Le corollaire est que si un coll√®gue vous demande de l'aide sur une linelist o√π les donn√©es sont √† jour dans la table mais n'apparaissent pas sur le graphique, les filtres sont probablement la source du probl√®me
:::

![Graphe un peu am√©lior√© pour un raport](../module_1/images/009-img-temporal-hospit_pimped.png){fig-align="center"}


#### Lieu : analyses spatiales

Rendons-nous maintenant sur la troisi√®me  feuille d'analyses. Elle nous montrer le **top 30** des zones de r√©sidence des cas, et en dessous, le top 30 des zones d'origine des cas (pour les patients qui ne font pas partie de la population d'accueil)^[Le nombre 30 est d√©fini dans le fichier **setup** et pourrait √™tre diff√©rent dans une autre liste lin√©aire].


Vous pouvez s√©lectionner le niveau administratif auquel vous voulez voir les donn√©es (1 √† 4).

::: {.instructions}
Cliquez sur le bouton bleu "S√©lectionnez votre niveau administratif" et testez les diff√©rentes options. 

- Quels niveaux ont des donn√©es (int√©ressantes) ?
- Combien de patients y-a-t'il √† Moissala Est ?
:::

Pour cette linelist, les donn√©es int√©ressantes sont au niveau "zone de responsabilit√©" (niveau admin 3), mais en fonction de vos donn√©es, d'autres niveaux pourraient √™tre pertinents √† regarder, si les personnes voyagent beaucoup, ou si vous avez cr√©e une liste lin√©aire "master" √† partir de plusieurs fichiers par exemple.


#### Lieu et temps : analyses spatio-temporelles

La derni√®re feuille d'analyse est un hybride entre la feuille d'analyse temporelle et celle d'analyse spatiale : elle vous permet de suivre ne nombre de cas dans quelques *endroits* de votre choix au cours du temps.


::: {.instructions}
1. Allez sur la feuille d'analyses spatio-temporelles

2. Placez votre curseur sur une des cellules bleu clair √† gauche (commen√ßant √† la cellule `C14`)

3. Cliquez sur le bouton ["GeoHelper"](../how_to/use_geohelper.qmd) du menu OBT et s√©lectionnez Moissala Est (niveau admin 3)

4. Allez √† la cellule bleu suivante, et r√©p√©tez les √©tapes pour s√©lectionner un autre endroit d'int√©r√™t (vous pouvez regarder le top 30 de la feuille d'analyse spatiale pour identifiez des lieux d'int√©r√™t, ou vous int√©resser √† un lieu avec des cas r√©cents)
:::


![Param√®tres des analyses spatio-temporelles](../module_1/images/010-img-spatio-temporal.png){fig-align="center"}

Nous arrivons √† la fin de notre *grand tour* des feuilles d'analyses.


## Partie 3 : r√©solution des probl√®mes de la liste lin√©aire 

### üß≠ Contexte

Vous avez d√©ploy√© la liste lin√©aire sur le terrain. Une personne charg√© de l'entr√©e des donn√©es d√©bute sur le fichier OBT et vous demande de l'aide. 

::: {.instructions}
Identifiez la source des probl√®mes suivants et proposez une solution.
:::

### Ouverture du fichier et autorisations

**Probl√®me** : votre coll√®gue ouvre le fichier et va sur le menu OBT comme vous lui avez expliqu√©, mais les boutons ne marchent pas, et n'ont pas de description (ou la description est du charabia).

::: {.callout-tip title="R√©ponse" collapse=true}
Les macros ne s'ex√©cutent pas ou pas correctement. Le plus probable est que les macros ne sont pas autoris√©es; plus rarement, le projet VBA ne s'est pas lanc√© correctement ou a plant√©. Que se passe-t-il ?

Demandez leur de fermer et r√©ouvrir le fichier pour voir si √ßa r√©sout le probl√®me (en particulier si la linelist marchait chez eux avant). Si le probl√®me persiste, v√©rifiez que le fichier est bien d√©bloqu√©, et qu'ils ont bien autoris√© les macros (voir @sec-unblock-file).
:::

### M√©connaissance g√©n√©rale du fichier

De nombreuses questions que vous pourrez avoir viennent du fait peu de gens lisent la documentation. En particulier, il est facile de manquer le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html) si one ne nous l'a pas montr√©. La bonne nouvelle est que un grand nombre de requ√™tes sont faciles √† r√©gler. 


#### Plus de place !

Vous recevez le mail suivant : 

> Hello, j'ai joint une linelist qui nous cause des probl√®mes. Certaines cellules sont bloqu√©es alors nous ne pouvons pas ajouter de nouveaux cas. Ca nous emp√™che de travailler alors aidez-nous s'il vous plait.

Comment r√©soudre le probl√®me ?

::: {.callout-tip title="R√©ponse" collapse=true}
Il faut utiliser le bouton "Ajouter des lignes" du menu OBT pour ajouter des lignes au bas de la feuille.

**Note**: les versions r√©centes de la liste lin√©aire ajoutent automatiquement cinq nouvelles lignes lorsque l'on rentre des donn√©es dans la derni√®re ligne, donc ce probl√®me devrait devenir moins courant. Par contre, √ßa veut dire qu'ils utilisent une *vieille* version et qu'il faudrait migrer les donn√©es vers une version plus r√©cente de la linelist !
:::


#### Lignes vides au milieu

Vous recevez le mail suivant : 

> Bonjour,  j'ai besoin de soutien sur la liste lin√©aire. Il y a des lignes vides (colori√©es en rouge) et je ne peux pas les supprimer parce que le fichier est prot√©g√©. Pouvez-vous m'aider ?

Comment r√©soudre le probl√®me ?

::: {.callout-tip title="R√©ponse"  collapse=true}
Utilisez le bouton "Redimensionner la table" du menu OBT, qui supprime toutes les lignes vides du tableau.
:::


#### Donn√©es manquantes

Vous recevez le mail suivant : 

> Bonsoir, nous avons entr√© des donn√©es dans la base de donn√©es mais des lignes manquent alors que nous ne les avons pas supprim√©es.

C'est p√©nible car il peut y avoir plusieurs sources √† ce probl√®me (et toutes n'ont pas de solution facile) : 

- Il y a un filtre appliqu√© quelque part et certaines lignes sont cach√©es
- Le document a √©t√© ferm√© (ou a plant√©) alors qu'il n'√©tait pas sauvegard√©, les donn√©es "d'hier" ou de "ce matin" ont √©t√© perdues.
- Il y a eu un probl√®me de synchronisation de OneDrive (le fichier local, plus r√©cent, a √©t√© √©cras√© par erreur par la version du serveur, plus ancienne)
- L'utilisateur a supprim√© des donn√©es par erreur. Vu que la feuille est prot√©g√©e, √ßa devrait √™tre rare mais on n'est jamais compl√®tement √† l'abris.

Il faudra discuter avec votre coll√®gue pour essayer de comprendre ce qui a pu se passer et voir si une version peut √™tre r√©cup√©r√©e quelque part. Mais commencez par v√©rifier les filtres au cas o√π √ßa soit un probl√®me facile √† r√©gler. Quel bouton utiliseriez-vous ?

::: {.callout-tip title="R√©ponse"  collapse=true}
Le bouton "Supprimer tous les filtres" du menu OBT.
:::


#### Analyses non actualis√©es

Vous recevez le mail suivant : 

> Bonjour, j'ai ajout√© des donn√©es dans le fichier mais le tableau de bord est vide / pas √† jour.

Comment r√©soudre le probl√®me ?

::: {.callout-tip title="R√©ponse"  collapse=true}
Utiliser le bouton "Actualiser les analyses" du menu OBT.
:::

Le jour suivant, vous recevez un autre message : 

> Bonjour, j'ai utilis√© le bouton hier et √ßa a bien march√©. Mais aujourd'hui, j'ai rentr√© de nouvelles donn√©es, utilis√© le bouton et les analyses sont barr√©es. Je ne peux pas enlever le texte barr√© et je n'ai rien fait d'autre, juste entr√© les donn√©es.

Une mise √† jour r√©cente^[Le probl√®me est apparu sur certains ordis √† partir de Novembre 2024.] d'Office 365 barre les valeurs qu'Excel consid√®re comme "obsol√®tes" (une valeur qui d√©pend d'autres valeurs, qui elles ont √©t√© modifi√©es). Pour des raisons que nous n'expliquerons pas ici, le bouton "Actualiser les analyses" ne suffit pas (encore) √† envoyer le signal √† Excel que toutes les cellules ont √©t√© recalcul√©es. Le probl√®me va √™tre r√©gl√©, mais en attendant, si √ßa vous arrive : 

- Sur la feuille patient, tapez **F9** (raccourci pour le bouton "Calculer maintenant" du menu Excel "Formules").
- *Ensuite*, utilisez le bouton "Actualiser les analyses" du menu OBT.

Si le probl√®me vous g√®ne souvent (et sur d'autres fichiers que les listes lin√©aires OBT) il est possible de [d√©sactiver](https://support.microsoft.com/fr-fr/office/mise-en-forme-des-valeurs-obsol%C3%A8tes-4b5c63c3-5dc7-4e9b-8e24-88bed1987dbd) cette nouvelle fonctionalit√© dans Excel.


### Envoi des donn√©es vers le tableau de bord

Une autre source commune de probl√®mes est l'√©tape du partage des donn√©es de la liste lin√©aire pour qu'elles soient mises sur le tableau de bord. Il est important d'expliquer les [√©tapes](https://epicentre-msf.github.io/outbreak-tools/how_to/send_data_to_dashboard.html) aux coll√®gues qui devront effectuer la manip. 

Pour vous entra√Æner, voici quelques probl√®mes communs; pourquoi √ßa ne marche pas ? 


- Les donn√©es ont √©t√© partag√©es avec le compte <EPI-DATA> via OneDrive, et n'apparaissent pas sur le dashboard.

- Le fichier `measles_linelist_moissala.xlsb`a √©t√© envoy√© par mail √† <EPI-DATA@epicentre.msf.org> et une erreur est revenue.

- Le fichier `measles_linelist_moissala_export_data_20250203-1136.xlsx` a √©t√© envoy√© par mail √† <EPI-DATA@epicentre.msf.org> et une erreur est revenue.

- Le fichier `MSL_linelist__MSL24__info_country_code__info_organisation__info_facility_name__anonymous__vb-1003__20250103-1541` a √©t√© envoy√© par mail √† <EPI-DATA@epicentre.msf.org>. Il n'y a pas eu d'erreur, mais les donn√©es n'apparaissent pas sur le tableau de bord pour le Tchad...


::: {.callout-tip collapse=true title="Indice"}
L'export pour le dashboard devrait √™tre nomm√© `MSL_linelist__MSL24__TCD__MSF-OCP__Mandoul Hospital__anonymous__vb-1003__20250103-1541`
:::


::: {.callout-tip collapse=true title="R√©ponse"}
Soit le fichier de la liste lin√©aire entier ou le mauvais export (export pour la migration) ont √©t√© envoy√©s, soit le bon fichier a √©t√© envoy√©, mais les m√©tadonn√©es n'√©taient pas remplies correctement sur la feuille "Info". 
:::


### Probl√®mes avanc√©s

Parfois le probl√®me est moins √©vident, ou peut avoir plusieurs causes entrem√™l√©es, et il faut enqu√™ter un peu plus.

::: {.instructions}
Ouvrez le fichier Excel `resolution_problemes.xlsb` de l'archive que vous avez t√©l√©charg√©e en d√©but de l'exercice.
:::

Votre coll√®gue vous a contact√©. Ille a des donn√©es pour le d√©but de Janvier 2023. Les analyses ne sont pas correctes alors qu'elle *ont √©t√© mises √† jour*.

**Probl√®me 1.** Il y a des cas positifs √† la rougeole dans les donn√©es, mais on ne les voit pas dans la table univari√©e sur le r√©sultat du test.

**Probl√®me 2.** Le registre indique qu'il y a eu 25 notifications la premi√®re semaine, et 40 la seconde, mais les chiffres sur la courbe √©pid√©mique ne sont pas corrects. Par contre, le r√©sum√© du nombre de notification total sur la feuille Univari√©e est correct (65 patients).

**Probl√®me 3.** Il y a eu cinq patients d√©c√©d√©s dans le centre, 3 notifi√©s en semaine 1 et 2 en semaine 2. Mais les chiffres sur la feuille d'analyses temporelles sont faux.


::: {.instructions}
Explorer la liste lin√©aire et enqu√™tez pour trouver la cause des probl√®mes. S'ils sont faciles √† r√©soudre, faites la correction. R√©fl√©chissez √† quels retours faire √† vos collaborateurs pour qu'ils √©vitent ces erreurs ou les r√©solvent eux m√™me.
:::


::: {.callout-note title="Indices" collapse=true}
**Probl√®me 1.** V√©rifiez les valeurs dans le dropdown menu pour la colonne incrimin√©e, et les donn√©es entr√©es √† l'aide du filtre.

**Probl√®me 2.** Par construction, les analyses temporelles n√©cessitent des dates.

**Probl√®me 3.** Le probl√®me est multifactoriel. Peut √™tre une des causes a pu disparaitre en fonction de ce que vous avez fait pour les probl√®mes diff√©rents.
:::


::: {.callout-note title="Indices suppl√©mentaires" collapse=true}
**Probl√®me 3.** Est ce que toutes les dates sont correctes ? Est-ce que toutes les cat√©gories de la colonne "Type de sortie" sont valides ? Si oui, qu'est ce qui pourrait affecter une graphe qui n√©cessite une semaine √©pid√©mique ?
:::


::: {.callout-note title="Un dernier indice" collapse=true}
**Probl√®me 3.** Peut √™tre allez relire la @sec-customise au cas o√π il y a un param√®tre √† changer...
:::


::: {.callout-tip title="R√©ponse" collapse=true}
**Probl√®me 1.** Des valeurs qui ne correspondent pas au menu d√©roulant ont √©t√© entr√© de force dans la colonne. Ces valeurs sont non valides et n'apparaissent pas dans le graphe ("Pos" au lieu de "Positif")


**Probl√®me 2.** La variable "date de notification" n'a pas √©t√© v√©rifi√©e et nettoy√©e, et certaines valeurs ne sont m√™me pas reconnues comme des dates par Excel. Les patients correspondant ne peuvent donc pas appara√Ætre dans les analyses _temporelles_ vu que les formules sur la date plantent. Par contre, le r√©sum√© g√©n√©ral de la feuille univari√© n'est pas conditionnel √† la date (pas pour le nombre total de patients en tout cas), et n'est donc pas affect√© par le probl√®me.

**Probl√®me 3.** Une des dates de notification √©tait mal rentr√©e, et pas reconnue comme date. Une des valeurs du type de sortie avait une faute d'orthographe. Enfin, la date de d√©but de semaine √©tait param√©tr√© pour le dimanche, alors que ce devrait √™tre le lundi pour le Tchad. Regardez la colonne calcul√©e "semaine de notification", changez le jour de d√©but de semaine (menu OBT) et voyez-la se mettre √† jour (utilisez F9 pour recalculer si n√©cessaire).
:::

Ce troisi√®me probl√®me √©tait un peu vicieux, mais √ßa peut facilement se produire dans un pays ou le d√©but de semaine n'est pas le m√™me que par d√©faut (lundi), si quelqu'un a oubli√© de param√©trer le fichier.


## Partie 4 : le tableau de bord

### üß≠ Contexte

La liste lin√©aire est d√©ploy√©e sur le terrain, et vous et vos coll√®gues avez d√©cid√© que les donn√©es devraient √™tre envoy√©es √† Epicentre pour compilation et affichage sur le dashboard. Ainsi, vous pourrez utiliser le tableau de bord pour suivre l'√©volution de l'√©pid√©mie au Tchad, et avoir acc√®s √† la carte des cas.


### Acc√©der au tableau de bord

Pour vous connecter au tableau de bord, il vous faut un compte; la cr√©ation de ce compte est semi-automatique si vous avez une adresse MSF : allez sur  [cette page](https://reports.msf.net/signup/).^[Si vous n'avez pas d'adresse MSF mais pensez que vous devriez avoir acc√®s au tableau de bord, contactez l'√©quipe EpiDS.]

Une fois que vous avez un compte, connectez vous au [tableau de bord intersection](https://apps.epicentre-msf.org/secure/app/intersectional-surveillance) et utilisez votre compte cr√©√© pour vous connecter.


### Menu des filtres

Sur la gauche (num√©ro "1" sur @fig-dashboard) vous avez le menu des options, o√π vous pouvez filtrer les donn√©es (maladies, sections, pays, site, type de sortie etc.) et param√©trer quelques options.

![Tableau de bord](../module_1/images/012-img-dashboard.png){fig-align="center" #fig-dashboard}


::: {.instructions}
- S√©lectionnez "Rougeole" dans le menu des maladies
- S√©lectionnez "Tchad" dans le menu des pays
- Cliquez sur le bouton "Update" en bas de la barre latt√©rale pour appliquer les filtres et mettre √† jour le tableau de bord.
:::

Maintenant, le dashboard ne montre que les cas de rougeole au Tchad.


### La carte

Int√©ressons-nous d'abord √† la carte.

::: {.instructions}
- Zoomez sur la carte pour vous focaliser sur le Tchad
- S√©lectionnez le niveau ADM1 pour avoir une meilleure r√©solution. Quelle r√©gion de sant√© a le plus de cas ?
- S√©lectionnez le niveau ADM2 pour voir encore plus pr√©cis√©ment. Quel district a le plus de cas ? Combien de patients n'ont pas de donn√©es g√©o rentr√©es ou valides √† cette r√©solution ?
- S√©lectionner enfin le niveau ADM3. Que pensez vous de la compl√©tude des donn√©es √† ce niveau de r√©solution ?
:::

Le bouton "Options" en haut de la carte vous permet d'ajuster la taille des cercles pour √©viter qu'ils ne se recouvrent, et de grouper les donn√©es en fonction de certaines variables.

::: {.instructions}
Groupez les donn√©es en fonction de si les patients sont hospitalis√©s ou pas. Est-ce qu'il y a une diff√©rence entre Moissala et Djodo Gassa ?
:::

::: {.callout-tip}
1. Il y a un bouton √† gauche de la carte (num√©ro "3" on @fig-dashboard) qui permet de changer le fond de carte et de cacher / montrer les cercles ou les taux d'attaques pour am√©liorer la lisibilit√©

2. Si vous cliquez sur une r√©gion donn√©e, la courb√© √©pid√©mique et la pyramide d'√¢ge se mettront √† jour pour ne montrer que les donn√©es des patients de cette r√©gion. La r√©gion s√©lectionn√©e est entour√©e d'un liser√© rouge. Cliquez sur la r√©gion une seconde fois pour la d√©s√©lectionner.
:::


### La courbe √©pid√©mique

La figure en haut √† droite est une courbe √©pi. Par d√©faut elle ressemble √† ceci pour le Tchad (√† l'√©poque en tout cas).

![Apparence par d√©faut de la courbe √©pi](../module_1/images/013-img-epicurve.png){fig-align="center" #fig-dashboard}

::: {.instructions}
Utilisez les options du graphe (num√©ro 4 on @fig-dashboard) pour le modifier de telle sorte qu'il ressemble √† ceci : 

![Hospitalisations au cours du temps](../module_1/images/014-img-epicurve-2.png){fig-align="center"}
:::

::: {.callout-tip}
1. La carte et la courbe √©pi ont un bouton "focus" en bas √† droite, qui apparait quand on passe la souris dessus, et qui permet de passer la figure en plein √©cran ce qui est pratique si votre √©cran est petit (num√©ro 5 on @fig-dashboard).

2. Sur la courbe √©pi, vous pouvez faire glisser votre souris pour zoomer sur une p√©riode donn√©e. Un bouton "reset" permet de revenir √† la vue par d√©faut.

3. Cliquez sur une barre du graphique pour mettre √† jour la pyramide d'√¢ge et la carte pour ne montrer que les cas de cette p√©riode. Un fond gris indique qu'une barre est s√©lectionn√©e. Cliquez une seconde fois sur la barre pour la d√©s√©lectionner.

4. Cliquez sur une cat√©gorie dans la l√©gende pour la d√©s√©lectionner et ne montrer que quelques cat√©gories. Par exemple, sur le graphique ci-dessus vous pourriez d√©cider de ne montrer que les patients hospitalis√©s en deux clics, ce qui est peut √™tre plus rapide que d'ajuster les filtres globaux avec le menu lat√©ral.
:::


### A votre tour

::: {.instructions}
Explorez le dashboard et r√©pondez aux questions suivantes :

- Quand est ce que le tableau de bord a √©t√© mis √† jour pour la derni√®re fois pour la rougeole ? (Indice : pas besoin de fouiller les sous-menus, c'est marqu√© sur la page principale)

- Quel pays a eu le plus de cas notifi√©s vis la liste lin√©aire en 2024 ? Combien d'enfants de moins de six mois ont √©t√© notifi√©s ? Et en particulier, combien de filles ?

- Quand est-ce que le tableau de bord a √©t√© mis √† jour pour la derni√®re fois pour l'h√©patite E ?

- Combien de consultations chol√©ra MSF OCG a-t'elle effectu√© dans les 90 derniers jours ?
:::

## Aller plus loin

- Allez sur le site contenant la [Documentation]() and lisez comment [migrer les donn√©es et cr√©er une liste lin√©aire "master"](https://epicentre-msf.github.io/outbreak-tools/how_to/migrate_linelist.html)