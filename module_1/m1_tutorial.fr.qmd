---
title: "Tutoriel"
---

## A propos de ce tutoriel

Dans ce tutoriel vous apprendrez √† conna√Ætre l'interface des listes lin√©aires OutbreakTools^[Pour rappel, toutes les listes lin√©aires OBT ont la m√™me interface] et le tableau de bord correspondant.

### üéØ Objectifs

- Explorer les fonctionnalit√©s de la liste lin√©aire OBT, en insistant sur la r√©solution de probl√®mes et l'exploration des analyses
- Acc√©der et savoir utiliser le tableau de bord intersection

#### üß≠ Contexte

MSF travaille dans l'est et le sud du Tchad depuis 2006 et fournit des soins m√©dicaux et une assistance aux personnes d√©plac√©es et aux communaut√©s locales dans un contexte d'acc√®s difficile √† la nourriture.

En d√©cembre 2021, suite √† plusieurs signalements de cas de rougeole dans la r√©gion m√©ridionale de Mandoul, MSF a d√©cid√© de r√©pondre √† l'√©pid√©mie avec Epicentre en soutien. 

Une liste lin√©aire est n√©cessaire pour collecter les donn√©es des patients dans les structures. Vous discutez avec le MedRef et le MedCo, et prenez la d√©cision de d√©ployer la liste lin√©aire rougeole OBT.


### Activit√©s

Vous utiliserez plusieurs fichier lors de ce tutoriel :

- une liste lin√©aire vide √† pr√©parer avant un d√©ploiement
- une liste lin√©aire avec de fausses donn√©es pour r√©pliquer une liste lin√©aire en cours d'utilisation
- une liste lin√©aire avec de fausses donn√©es et quelques probl√®mes √† r√©soudre.

Vous visiterez ensuite le tableau de bord Intersection pour explorer les donn√©es _r√©elles_ de MSF sur la rougeole au Tchad.

Les explications seront donn√©es dans le texte ou dans des encadr√©s (conseils, notes, etc.) et les instructions seront donn√©es dans des encadr√©s.

::: {.callout-warning}
Je suis une information importante
:::

::: {.callout-tip}
Je suis une information utile mais qui peut √™tre omise si vous √™tes press√© par le temps, mais je m√©rite qu'on me lise √† un moment.
:::

::: {.instructions}
A votre tour de faire !
:::

## Pr√©paration

### T√©l√©chargez et d√©zippez les documents

Les fichiers que vous devrez utiliser sont stock√©s sur GitHub dans une archive `zip`. 

::: {.instructions}
1. Cliquez sur le bouton ci-dessous pour t√©l√©charger l'archive. Enregistrez-la sur votre ordinateur (dans vos *T√©l√©chargements* par exemple)

```{r}
#| echo: false
#| eval: true

downloadthis::download_link(
  link = "https://github.com/epicentre-msf/obt-training/raw/master/tutorials_materials/module_1.zip",
  button_label = "T√©l√©charder l'archive",
  has_icon = TRUE,
  icon = "fa fa-save",
  self_contained = FALSE
)
```

2. D√©zippez l'archive pour sauver les fichiers localement. Il est conseill√© de d√©zipper vers un emplacement qui n'est pas activement synchronis√© avec OneDrive en ce moment.
:::


### Contenu de larchive

- Une liste lin√©aire OBT rougeole √† jour (version standard), vide
- La m√™me version de fichier, mais avec des donn√©es rougeole (simul√©es)


## Partie 0 : d√©bloquer les fichiers et les macros {#sec-unblock-file}

Les listes lin√©aires OBT utilisent des macros VBA pour ajouter des fonctionnalit√©s. Cela fait qu'elles doivent souvent √™tre d√©loqu√©es sur votre ordi lorsque qu'elles viennent d'internet, et vous devrez autoriser l'ex√©cution des macros.


::: {.instructions}
D√©bloquez les fichiers ou assurez-vous qu'ils le sont d√©j√†. Si vous ne l'avez jamais fait auparavant, [suivez ces √©tapes](../how_to/unblock_files.qmd)
:: :

:: : {.callout-note}
En fonction du niveau de protection de votre ordinateur et de la source des fichiers, vous arez peut √™tre √† le faire ou non. Par contre, les ordinateurs terrain sont souvent plus prot√©g√©s et et est tr√®s probable que certain de vos coll√®gues aient √† le faire, donc soyez pr√™t √† expliquer.
:::

## Partie 1: pr√©parer et d√©ployer une liste lin√©aire

### Obtenir fichiers n√©c√©ssaires

#### Un mod√®le de liste lin√©aire

Dans la vraie vie il vous faudra un [mod√®le vide](https://epicentre-msf.github.io/outbreak-tools/getting_started/get_linelist.html) pour vous lancer, mais dans le cadre ce cet exercice vous utiliserez le fichier vide inclus dans l'archive que vous avez t√©l√©charg√©e.

::: {.instructions}
Identifiez le fichier correct et faites une copie pour pouvoir travailler dessus.
:::


#### Une g√©obase adapt√©e

::: {.instructions}
Rendez-vous sur le site [GeoApp](https://reports.msf.net/secure/app/outbreak-tools-geoapp) et t√©l√©chargez une base g√©o pour le Tchad. Vous pouvez lire un r√©sum√© des √©tapes [ici](https://epicentre-msf.github.io/outbreak-tools/how_to/import_geobase.html#sec-geobase-download), ou directement sur le site, √† l'ouverture.
:::

Le fichier n'est pas prot√©g√©, vous pouvez l'ouvrir si vous √™tes curieux.


### Adapter une liste lin√©aire {#sec-customise}

::: {.instructions}
Ouvrez la liste lin√©aire et inspectez les (noms des) onglets
:::

**Notablement**: 

- La premi√®re feuille contient des instructions, il n'y a rien √† faire dessus √† part les lire
- La deuxi√®me feuille ("Info") contient des informations sur le projet et le site (m√©tadonn√©es)
- La troisi√®me feuille ("Linelist patients") contient les donn√©es des patients
- La plupart des feuilles suivantes contiennent des analyses.

::: {.instructions}
Localisez le [menu OutbreakTools](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html), nous allons l'utiliser intensivement pendant les exercices.
:::


![Rubban, ou menu OutbreakTools](../module_1/images/015-img-ribbon-linelist.png){fig-align="center"}


#### Remplir les m√©tadonn√©es

**M√©tadonn√©es obligatoires**

::: {.instructions}
Remplissez la feuille "Info" (m√©tadonn√©es) :

- `Organisation`: entrez votre nom de section
- `Nom du pays`: Tchad
- `Nom de la structure`: Mo√Øssala Hospital
:::

Une fois que ces champs sont remplis, ils ne devraient plus √™tre modifi√©s. Ces informations seront utilis√©es au moment de la cr√©ation d'exports.

**M√©tadonn√©es optionnelles**

::: {.instructions}
Rentrez les infos des champs `Admin 1` (Mandoul) et `Admin 2` (Moissala)
:::


#### Cacher les champs non utilis√©s

Vu que l'on n'a pas utilis√© les autres champs, cachons-les !

::: {.instructions}
En gardant le focus sur la feuille "Info", rendez-vous dans le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html). Cliquez sur le bouton "Afficher / Masquer les variables".
:::

Une fen√™tre pop-up s'ouvre :


![Fen√™tre pop-up](../module_1/images/003-img-obt-show_hide.png){fig-align="center"}

Vous pouvez voir que certaines variables ont un statut `Obligatoire`; ces variables ne peuvent √™tre cach√©es avec cet outil. D'autres variables ont le statut "Affich√©" et elles peuvent √™tre cach√©es. 

::: {.instructions} 
Cachez les variables que l'on n'a pas remplies. Vous pouvez soit les cacher unes par unes, soit utiliser le bouton "Cachez toutes les variables optionnelles" deux fois et d√©-cacher les variables que l'on veut voir.
:::


#### Importer la g√©obase

::: {.instructions} 
Cliquez sur le menu "Importer une g√©obase" dans le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html) pour importer la base g√©o que vous avez t√©l√©charg√© pr√©c√©demment.
:::

Apr√®s avoir re√ßus le message de confirmation, vous pouvez v√©rifier l'import en allant sur la feuille des donn√©es patients, et en regardant les colonnes "g√©o", celles avec un fond couleur saumon. Si tout s'est bien pass√© :

- Les labels devraient avoir √©t√© mis √† jour avec les noms des niveaux administratifs pr√©sents dans la g√©obase (e.g. adm1_name‚Äù va devenir ‚ÄúProvince‚Äù pour la RDC).
- Les cellules de la premi√®re colonne (admin 1) devraient contenir un menu d√©roulant avec les valeurs import√©es depuis la g√©obase.

Vous pouvez remplir les colonnes g√©ographiques soit √† partir des menus d√©roulants en cascade (en commen√ßant pas le niveau 1 !), soit en utilisant le bouton [GeoHelper](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html#sec-geo-helper) du menu OBT.

::: {.callout-important}
Il y a une hi√©rarchie entre les niveaux administratifs: si vous essayez de remplir la colonne 3 *sans avoir rempli les colonnes 1 et 2* le menu d√©roulant apparaitra comme vide.
:::


#### Param√©trer le jour de la semaine
  
::: {.instructions} 
Cliquez sur le bouton "D√©but de semaine" du menu OBT et choisissez le "Lundi" comme premier jour de la semaine.
:::

#### Cachez / montrer des variables

On peut aussi cacher ou montrer les variables optionnelles sur cette feuille (comme pour la feuille "Info"). Lorsque vous pr√©parerez une liste lin√©aire, il vous faudra d√©cider quelles variables collecter en fonction informations dont vous avez besoin^[Vous pouvez cacher ou montrer des variables plus tard, pendant la collecte des donn√©es si besoin, mais dans ce cas gardez en t√™te que les donn√©es pour ces colonnes ne seront que partielles.].


::: {.instructions} 
Placez(vous sur la feuille "Linelist Patients" et cliquez sur le bouton "Afficher/Masquer des variables". Cachez toutes les variables optionnelles √† l'aide du bouton, et d√©-cachez manuellement :

- Structure d√©clarante
- Fi√®vre
- Eruption maculopapulaire
- Toux
- Yeux rouges - conjonctivite
- MUAC
- Enceinte
- Les variables "extra" √† la fin
- N'importe quelle variable calcul√©e que *vous* souhaitez voir (num√©ro de semaine, groupe d'√¢ge  etc.)
:::


#### Imprimer un registre

::: {.instructions}
Cliquez sur le bouton "Afficher le registre" du [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html).
:::

Cela ouvre une feuille qui est cach√©e par d√©faut pour pr√©parer un registre √† imprimer, au cas o√π il n'y en aurait pas d√©j√† un dans le centre.

En r√®gle g√©n√©rale, il devrait y avoir moins de colonnes dans le registre que dans la linelist, vu que certaines des informations viennent du dossier patient ou d'autres sources.

::: {.instructions}

1. Une fois sur la nouvelle feuille cr√©ez, cliquez sur le bon vieux bouton "Afficher/masquer les variables" pour ouvrir la fen√™tre pop-up pour le registre.

2. Cliquez que le bouton "Correspondre au Show/Hide de la linelist" pour aligner la visibilit√© des variables du registre sur celles de la feuille patients.

3. Cachez les variables qui n'ont pas besoin d'√™tre dans le registre.
:::


Maintenant que vous avez s√©lectionn√© les variables √† imprimer, il faut am√©liorer un peu l'aspect pour qu'il soit plus pratique √† utiliser :

- Ajuster la largeur des colonnes pour que les encodeurs de donn√©es puisse √©crire
- Changer l'orientation des labels pour gagner de l'espace s'il n'y a pas grand chose √† √©crire
- Ajouter des lignes √† la table pour qu'elle fasse une page^[Astuce: il y a un bouton pour √ßa dans le menu OBT !].

::: {.instructions}
Ajustez la largeur des colonnes : 

- `Nom / Pr√©nom`: plus large
- `Sexe`: moins large

Pour voir, cliquez sur le bouton "Imprimer" (toujours dans le [menu OBT menu](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html)). Remarquez le bouton "Mise en page" en haut √† gauche, qui contr√¥le les param√®tres d'impression.

Une fois que vous avez pris connaissance de ces boutons, vous pouvez sortir de l'aper√ßu avant impression puis cliquer sur le bouton "Fermer le registre / CRF" pour **cacher** la feuille registre (vos modifications sur cette feuille demeurent).
:::

#### Pr√©parer un formulaire des cas

Avec la m√™me id√©e que pour le registre il est possible d'imprimer un formulaire de cas √† partir de la liste lin√©aire s'il n'y en a pas d√©j√† un dans la structure. Un bouton affiche une feuille pr√©par√©e automatiquement. Cr√©er un CRF propre est au del√† de nos capacit√©s pour le moment, mais ce brouillon devrait √™tre une base et vous faire gagner du temps.

Chose que vous pourriez faire :

- Cacher les variables collect√©es √† un autre endroit ou calcul√©es
- Cacher / condenser des lignes vide
- Raccourcir des labels^[D√©sormais, une option a √©t√© rajout√©e au ficher **setup** pour donner des labels courts ou des acronymes, mais ils n'ont pas √©t√© remplis pour toutes les liste lin√©aires OBT en circulation pour le moment.].

Pr√©parer un CRF propre nous prendrait trop de temps, nous ne le ferons pas lors de ce tutoriel, mais n'h√©sitez pas √† ouvrir la feuille un instant avec le bouton "Afficher le CRF" pour voir √† quoi elle ressemble.


### D√©ployer la linelist

Nous avons fait le tour des pr√©parations principales √† effectuer sur la liste lin√©aire. N'oubliez pas d'enregistrer vvotre fichier.

Vous pouvez √† pr√©sent l'envoyer √† vos coll√®gues. S'ils ont d√©j√† travaill√© avec des linelists OBT (y compris sur d'autres maladies), c'est facile : toutes les listes lin√©aires OBT ont la m√™me interface, ils devraient se sentir √† l'aise.

Si vos coll√®gues n'ont pas travaill√© avec une liste lin√©aire OBT, il faut leur montrer en particulier : 

- Comment [d√©bloquer le fichier et autoriser les macros](../how_to/unblock_files.qmd)
- le [menu OBT](https://epicentre-msf.github.io/outbreak-tools/reference/ribbons_linelist.html)
- Comment remplir les m√©tadonn√©es sur la feuille "Info" (s'il en reste √† remplir)
- Comment [exporter les donn√©es vers le tableau de bord](https://epicentre-msf.github.io/outbreak-tools/how_to/send_data_to_dashboard.html)
- Comment utiliser le bouton [GeoHelper](../how_to/use_geohelper.qmd)

Le plus souvent il devrait y avoir une liste lin√©aire par site.

